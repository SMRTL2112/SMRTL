select distinct sa.original_coc "sample_code",
'URINE' "sample_type",
to_char(nvl(a.receive_date,sa.receive_date),'YYYY-MM-DD') "date_received",
ad1.aux_data "ta",
ad2.aux_data "sca",
'A' "sampleAB",
get_sg(sa.hsn) "confirmed_specific_gravity",
't/e' "ster_prof_variable_code1",
nvl(sd.RESULT_NBR,round(ar.cmp_result,2)) "ster_prof_variable_confirmed1",
round(nvl(sd.RESULT_NBR,ar.cmp_result)*0.15,2) "ster_prof_variable_uc1"
from samples sa
inner join profiles p on p.reqnbr = sa.reqnbr
inner join customers c on c.cust_id = p.cust_id
left outer join schedules sc on sc.schedule_id = sa.hsn and sc.schedule_type = 'S' and sc.queue in('STER','GSCR') and sc.active_flag = 'F' and sc.proc_code = 'TE RESCRN'
left outer join analytical_results ar on ar.schedule_seq = sc.schedule_seq and ar.cmp = 't/e'
left outer join airbills a on rtrim(a.original_coc,'_!') = sa.original_coc
left outer join aux_Data ad2 on ad2.aux_data_id = c.cust_seq and ad2.aux_data_type = 'C' and ad2.aux_data_format = 'ADMS' and ad2.aux_field = 2
left outer join aux_Data ad1 on ad1.aux_data_id = c.cust_seq and ad1.aux_data_type = 'C' and ad1.aux_data_format = 'ADMS' and ad1.aux_field = 1
left outer join sample_drugs sd on sd.hsn = sa.hsn and sd.cmp = 't/e' and substr(sd.flags,1,1) = 'C'
where sa.hsn in (
283177,
283192,
286924,
286019,
283188,
284390,
288536,
289700,
281956,
292104,
288491,
294697,
297300,
291755,
290347,
292102,
294936,
303602,
303611,
313486,
260404,
309390,
304809,
318713,
319747,
318434,
317814,
320368,
315123,
320300,
319737,
306667,
318159,
321504,
319716,
319855,
314446,
314753,
326236,
326206,
317801,
312033,
328183,
327157,
329710,
330036,
324398,
323945,
262283,
264501,
262278,
266592,
264561,
264557,
269482,
270158,
268519,
270712,
272132,
264534,
266366,
268798,
273204,
274812,
277891,
278170,
277877,
272387,
277376,
271374,
274944,
281978,
281976,
284973,
284742)
order by 10;

